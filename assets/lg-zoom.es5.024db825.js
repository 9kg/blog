/*!
 * lightgallery | 2.5.0 | June 13th 2022
 * http://www.lightgalleryjs.com/
 * Copyright (c) 2020 Sachin Neravath;
 * @license GPLv3
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var y=function(){return y=Object.assign||function(t){for(var e,o=1,a=arguments.length;o<a;o++){e=arguments[o];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},y.apply(this,arguments)},S={scale:1,zoom:!0,actualSize:!0,showZoomInOutIcons:!1,actualSizeIcons:{zoomIn:"lg-zoom-in",zoomOut:"lg-zoom-out"},enableZoomAfter:300,zoomPluginStrings:{zoomIn:"Zoom in",zoomOut:"Zoom out",viewActualSize:"View actual size"}},p={afterAppendSlide:"lgAfterAppendSlide",init:"lgInit",hasVideo:"lgHasVideo",containerResize:"lgContainerResize",updateSlides:"lgUpdateSlides",afterAppendSubHtml:"lgAfterAppendSubHtml",beforeOpen:"lgBeforeOpen",afterOpen:"lgAfterOpen",slideItemLoad:"lgSlideItemLoad",beforeSlide:"lgBeforeSlide",afterSlide:"lgAfterSlide",posterClick:"lgPosterClick",dragStart:"lgDragStart",dragMove:"lgDragMove",dragEnd:"lgDragEnd",beforeNextSlide:"lgBeforeNextSlide",beforePrevSlide:"lgBeforePrevSlide",beforeClose:"lgBeforeClose",afterClose:"lgAfterClose",rotateLeft:"lgRotateLeft",rotateRight:"lgRotateRight",flipHorizontal:"lgFlipHorizontal",flipVertical:"lgFlipVertical",autoplay:"lgAutoplay",autoplayStart:"lgAutoplayStart",autoplayStop:"lgAutoplayStop"},b=function(){function n(t,e){return this.core=t,this.$LG=e,this.settings=y(y({},S),this.core.settings),this}return n.prototype.buildTemplates=function(){var t=this.settings.showZoomInOutIcons?'<button id="'+this.core.getIdName("lg-zoom-in")+'" type="button" aria-label="'+this.settings.zoomPluginStrings.zoomIn+'" class="lg-zoom-in lg-icon"></button><button id="'+this.core.getIdName("lg-zoom-out")+'" type="button" aria-label="'+this.settings.zoomPluginStrings.zoomIn+'" class="lg-zoom-out lg-icon"></button>':"";this.settings.actualSize&&(t+='<button id="'+this.core.getIdName("lg-actual-size")+'" type="button" aria-label="'+this.settings.zoomPluginStrings.viewActualSize+'" class="'+this.settings.actualSizeIcons.zoomIn+' lg-icon"></button>'),this.core.outer.addClass("lg-use-transition-for-zoom"),this.core.$toolbar.first().append(t)},n.prototype.enableZoom=function(t){var e=this,o=this.settings.enableZoomAfter+t.detail.delay;this.$LG("body").first().hasClass("lg-from-hash")&&t.detail.delay?o=0:this.$LG("body").first().removeClass("lg-from-hash"),this.zoomableTimeout=setTimeout(function(){!e.isImageSlide()||(e.core.getSlideItem(t.detail.index).addClass("lg-zoomable"),t.detail.index===e.core.index&&e.setZoomEssentials())},o+30)},n.prototype.enableZoomOnSlideItemLoad=function(){this.core.LGel.on(p.slideItemLoad+".zoom",this.enableZoom.bind(this))},n.prototype.getModifier=function(t,e,o){var a=t;t=Math.abs(t);var s=this.getCurrentTransform(o);if(!s)return 1;var i=1;if(e==="X"){var g=Math.sign(parseFloat(s[0]));t===0||t===180?i=1:t===90&&(a===-90&&g===1||a===90&&g===-1?i=-1:i=1),i=i*g}else{var c=Math.sign(parseFloat(s[3]));if(t===0||t===180)i=1;else if(t===90){var h=parseFloat(s[1]),m=parseFloat(s[2]);i=Math.sign(h*m*a*c)}i=i*c}return i},n.prototype.getImageSize=function(t,e,o){var a={y:"offsetHeight",x:"offsetWidth"};return Math.abs(e)===90&&(o==="x"?o="y":o="x"),t[a[o]]},n.prototype.getDragCords=function(t,e){return e===90?{x:t.pageY,y:t.pageX}:{x:t.pageX,y:t.pageY}},n.prototype.getSwipeCords=function(t,e){var o=t.targetTouches[0].pageX,a=t.targetTouches[0].pageY;return e===90?{x:a,y:o}:{x:o,y:a}},n.prototype.getDragAllowedAxises=function(t,e){e=e||this.scale||1;var o=this.imageYSize*e>this.containerRect.height,a=this.imageXSize*e>this.containerRect.width;return t===90?{allowX:o,allowY:a}:{allowX:a,allowY:o}},n.prototype.getCurrentTransform=function(t){if(!!t){var e=window.getComputedStyle(t,null),o=e.getPropertyValue("-webkit-transform")||e.getPropertyValue("-moz-transform")||e.getPropertyValue("-ms-transform")||e.getPropertyValue("-o-transform")||e.getPropertyValue("transform")||"none";if(o!=="none")return o.split("(")[1].split(")")[0].split(",")}},n.prototype.getCurrentRotation=function(t){if(!t)return 0;var e=this.getCurrentTransform(t);return e?Math.round(Math.atan2(parseFloat(e[1]),parseFloat(e[0]))*(180/Math.PI)):0},n.prototype.setZoomEssentials=function(){var t=this.core.getSlideItem(this.core.index).find(".lg-image").first(),e=this.core.getSlideItem(this.core.index).find(".lg-img-rotate").first().get();this.rotateValue=this.getCurrentRotation(e),this.imageYSize=this.getImageSize(t.get(),this.rotateValue,"y"),this.imageXSize=this.getImageSize(t.get(),this.rotateValue,"x"),this.containerRect=this.core.outer.get().getBoundingClientRect(),this.modifierX=this.getModifier(this.rotateValue,"X",e),this.modifierY=this.getModifier(this.rotateValue,"Y",e)},n.prototype.zoomImage=function(t){var e=(this.containerRect.width-this.imageXSize)/2+this.containerRect.left,o=this.core.mediaContainerPosition,a=o.top,s=o.bottom,i=Math.abs(a-s)/2,g=(this.containerRect.height-this.imageYSize-i*this.modifierX)/2+this.scrollTop+this.containerRect.top,c,h;t===1&&(this.positionChanged=!1);var m=this.getDragAllowedAxises(Math.abs(this.rotateValue),t),u=m.allowY,r=m.allowX;this.positionChanged&&(c=this.left/(this.scale-1),h=this.top/(this.scale-1),this.pageX=Math.abs(c)+e,this.pageY=Math.abs(h)+g,this.positionChanged=!1);var l=this.getPossibleSwipeDragCords(this.rotateValue,t),v=e-this.pageX,z=g-this.pageY,f=(t-1)*v,d=(t-1)*z;r?this.isBeyondPossibleLeft(f,l.minX)?f=l.minX:this.isBeyondPossibleRight(f,l.maxX)&&(f=l.maxX):t>1&&(f<l.minX?f=l.minX:f>l.maxX&&(f=l.maxX)),u?this.isBeyondPossibleTop(d,l.minY)?d=l.minY:this.isBeyondPossibleBottom(d,l.maxY)&&(d=l.maxY):t>1&&(d<l.minY?d=l.minY:d>l.maxY&&(d=l.maxY)),this.setZoomStyles({x:f,y:d,scale:t})},n.prototype.setZoomStyles=function(t){var e=this.core.getSlideItem(this.core.index).find(".lg-image").first(),o=this.core.outer.find(".lg-current .lg-dummy-img").first(),a=e.parent();this.scale=t.scale,e.css("transform","scale3d("+t.scale+", "+t.scale+", 1)"),o.css("transform","scale3d("+t.scale+", "+t.scale+", 1)");var s="translate3d("+t.x+"px, "+t.y+"px, 0)";a.css("transform",s),this.left=t.x,this.top=t.y},n.prototype.setActualSize=function(t,e){var o=this;if(!(!this.isImageSlide()||this.core.outer.hasClass("lg-first-slide-loading"))){var a=this.getCurrentImageActualSizeScale();this.core.outer.hasClass("lg-zoomed")?this.scale=1:this.scale=this.getScale(a),this.setPageCords(e),this.beginZoom(this.scale),this.zoomImage(this.scale),setTimeout(function(){o.core.outer.removeClass("lg-grabbing").addClass("lg-grab")},10)}},n.prototype.getNaturalWidth=function(t){var e=this.core.getSlideItem(t).find(".lg-image").first(),o=this.core.galleryItems[t].width;return o?parseFloat(o):e.get().naturalWidth},n.prototype.getActualSizeScale=function(t,e){var o,a;return t>e?(o=t/e,a=o||2):a=1,a},n.prototype.getCurrentImageActualSizeScale=function(){var t=this.core.getSlideItem(this.core.index).find(".lg-image").first(),e=t.get().offsetWidth,o=this.getNaturalWidth(this.core.index)||e;return this.getActualSizeScale(o,e)},n.prototype.getPageCords=function(t){var e={};if(t)e.x=t.pageX||t.targetTouches[0].pageX,e.y=t.pageY||t.targetTouches[0].pageY;else{var o=this.core.outer.get().getBoundingClientRect();e.x=o.width/2+o.left,e.y=o.height/2+this.scrollTop+o.top}return e},n.prototype.setPageCords=function(t){var e=this.getPageCords(t);this.pageX=e.x,this.pageY=e.y},n.prototype.beginZoom=function(t){if(this.core.outer.removeClass("lg-zoom-drag-transition lg-zoom-dragging"),t>1){this.core.outer.addClass("lg-zoomed");var e=this.core.getElementById("lg-actual-size");e.removeClass(this.settings.actualSizeIcons.zoomIn).addClass(this.settings.actualSizeIcons.zoomOut)}else this.resetZoom();return t>1},n.prototype.getScale=function(t){var e=this.getCurrentImageActualSizeScale();return t<1?t=1:t>e&&(t=e),t},n.prototype.init=function(){var t=this;if(!!this.settings.zoom){this.buildTemplates(),this.enableZoomOnSlideItemLoad();var e=null;this.core.outer.on("dblclick.lg",function(o){!t.$LG(o.target).hasClass("lg-image")||t.setActualSize(t.core.index,o)}),this.core.outer.on("touchstart.lg",function(o){var a=t.$LG(o.target);o.targetTouches.length===1&&a.hasClass("lg-image")&&(e?(clearTimeout(e),e=null,o.preventDefault(),t.setActualSize(t.core.index,o)):e=setTimeout(function(){e=null},300))}),this.core.LGel.on(p.containerResize+".zoom "+p.rotateRight+".zoom "+p.rotateLeft+".zoom "+p.flipHorizontal+".zoom "+p.flipVertical+".zoom",function(){!t.core.lgOpened||!t.isImageSlide()||(t.setPageCords(),t.setZoomEssentials(),t.zoomImage(t.scale))}),this.$LG(window).on("scroll.lg.zoom.global"+this.core.lgId,function(){!t.core.lgOpened||(t.scrollTop=t.$LG(window).scrollTop())}),this.core.getElementById("lg-zoom-out").on("click.lg",function(){t.core.outer.find(".lg-current .lg-image").get()&&(t.scale-=t.settings.scale,t.scale=t.getScale(t.scale),t.beginZoom(t.scale),t.zoomImage(t.scale))}),this.core.getElementById("lg-zoom-in").on("click.lg",function(){t.zoomIn()}),this.core.getElementById("lg-actual-size").on("click.lg",function(){t.setActualSize(t.core.index)}),this.core.LGel.on(p.beforeOpen+".zoom",function(){t.core.outer.find(".lg-item").removeClass("lg-zoomable")}),this.core.LGel.on(p.afterOpen+".zoom",function(){t.scrollTop=t.$LG(window).scrollTop(),t.pageX=t.core.outer.width()/2,t.pageY=t.core.outer.height()/2+t.scrollTop,t.scale=1}),this.core.LGel.on(p.afterSlide+".zoom",function(o){var a=o.detail.prevIndex;t.scale=1,t.positionChanged=!1,t.resetZoom(a),t.isImageSlide()&&t.setZoomEssentials()}),this.zoomDrag(),this.pinchZoom(),this.zoomSwipe(),this.zoomableTimeout=!1,this.positionChanged=!1}},n.prototype.zoomIn=function(t){!this.isImageSlide()||(t?this.scale=t:this.scale+=this.settings.scale,this.scale=this.getScale(this.scale),this.beginZoom(this.scale),this.zoomImage(this.scale))},n.prototype.resetZoom=function(t){this.core.outer.removeClass("lg-zoomed lg-zoom-drag-transition");var e=this.core.getElementById("lg-actual-size"),o=this.core.getSlideItem(t!==void 0?t:this.core.index);e.removeClass(this.settings.actualSizeIcons.zoomOut).addClass(this.settings.actualSizeIcons.zoomIn),o.find(".lg-img-wrap").first().removeAttr("style"),o.find(".lg-image").first().removeAttr("style"),this.scale=1,this.left=0,this.top=0,this.setPageCords()},n.prototype.getTouchDistance=function(t){return Math.sqrt((t.targetTouches[0].pageX-t.targetTouches[1].pageX)*(t.targetTouches[0].pageX-t.targetTouches[1].pageX)+(t.targetTouches[0].pageY-t.targetTouches[1].pageY)*(t.targetTouches[0].pageY-t.targetTouches[1].pageY))},n.prototype.pinchZoom=function(){var t=this,e=0,o=!1,a=1,s=this.core.getSlideItem(this.core.index);this.core.$inner.on("touchstart.lg",function(i){s=t.core.getSlideItem(t.core.index),!!t.isImageSlide()&&i.targetTouches.length===2&&!t.core.outer.hasClass("lg-first-slide-loading")&&(t.$LG(i.target).hasClass("lg-item")||s.get().contains(i.target))&&(a=t.scale||1,t.core.outer.removeClass("lg-zoom-drag-transition lg-zoom-dragging"),t.core.touchAction="pinch",e=t.getTouchDistance(i))}),this.core.$inner.on("touchmove.lg",function(i){if(i.targetTouches.length===2&&t.core.touchAction==="pinch"&&(t.$LG(i.target).hasClass("lg-item")||s.get().contains(i.target))){i.preventDefault();var g=t.getTouchDistance(i),c=e-g;!o&&Math.abs(c)>5&&(o=!0),o&&(t.scale=Math.max(1,a+-c*.008),t.zoomImage(t.scale))}}),this.core.$inner.on("touchend.lg",function(i){t.core.touchAction==="pinch"&&(t.$LG(i.target).hasClass("lg-item")||s.get().contains(i.target))&&(o=!1,e=0,t.scale<=1?t.resetZoom():(t.scale=t.getScale(t.scale),t.zoomImage(t.scale),t.core.outer.addClass("lg-zoomed")),t.core.touchAction=void 0)})},n.prototype.touchendZoom=function(t,e,o,a,s,i){var g=e.x-t.x,c=e.y-t.y,h=Math.abs(g)/s+1,m=Math.abs(c)/s+1;h>2&&(h+=1),m>2&&(m+=1),g=g*h,c=c*m;var u=this.core.getSlideItem(this.core.index).find(".lg-img-wrap").first(),r={};r.x=this.left+g*this.modifierX,r.y=this.top+c*this.modifierY;var l=this.getPossibleSwipeDragCords(i);(Math.abs(g)>15||Math.abs(c)>15)&&(a&&(this.isBeyondPossibleTop(r.y,l.minY)?r.y=l.minY:this.isBeyondPossibleBottom(r.y,l.maxY)&&(r.y=l.maxY)),o&&(this.isBeyondPossibleLeft(r.x,l.minX)?r.x=l.minX:this.isBeyondPossibleRight(r.x,l.maxX)&&(r.x=l.maxX)),a?this.top=r.y:r.y=this.top,o?this.left=r.x:r.x=this.left,this.setZoomSwipeStyles(u,r),this.positionChanged=!0)},n.prototype.getZoomSwipeCords=function(t,e,o,a,s){var i={};if(a){if(i.y=this.top+(e.y-t.y)*this.modifierY,this.isBeyondPossibleTop(i.y,s.minY)){var g=s.minY-i.y;i.y=s.minY-g/6}else if(this.isBeyondPossibleBottom(i.y,s.maxY)){var c=i.y-s.maxY;i.y=s.maxY+c/6}}else i.y=this.top;if(o){if(i.x=this.left+(e.x-t.x)*this.modifierX,this.isBeyondPossibleLeft(i.x,s.minX)){var h=s.minX-i.x;i.x=s.minX-h/6}else if(this.isBeyondPossibleRight(i.x,s.maxX)){var m=i.x-s.maxX;i.x=s.maxX+m/6}}else i.x=this.left;return i},n.prototype.isBeyondPossibleLeft=function(t,e){return t>=e},n.prototype.isBeyondPossibleRight=function(t,e){return t<=e},n.prototype.isBeyondPossibleTop=function(t,e){return t>=e},n.prototype.isBeyondPossibleBottom=function(t,e){return t<=e},n.prototype.isImageSlide=function(){var t=this.core.galleryItems[this.core.index];return this.core.getSlideType(t)==="image"},n.prototype.getPossibleSwipeDragCords=function(t,e){var o=e||this.scale||1,a=Math.abs(o),s=this.core.mediaContainerPosition,i=s.top,g=s.bottom,c=Math.abs(i-g)/2,h=(this.imageYSize-this.containerRect.height)/2+c*this.modifierX,m=this.containerRect.height-this.imageYSize*a+h,u=(this.imageXSize-this.containerRect.width)/2,r=this.containerRect.width-this.imageXSize*a+u,l={minY:h,maxY:m,minX:u,maxX:r};return Math.abs(t)===90&&(l={minY:u,maxY:r,minX:h,maxX:m}),l},n.prototype.setZoomSwipeStyles=function(t,e){t.css("transform","translate3d("+e.x+"px, "+e.y+"px, 0)")},n.prototype.zoomSwipe=function(){var t=this,e={},o={},a=!1,s=!1,i=!1,g=new Date,c=new Date,h,m,u=this.core.getSlideItem(this.core.index);this.core.$inner.on("touchstart.lg",function(r){if(!!t.isImageSlide()&&(u=t.core.getSlideItem(t.core.index),(t.$LG(r.target).hasClass("lg-item")||u.get().contains(r.target))&&r.targetTouches.length===1&&t.core.outer.hasClass("lg-zoomed"))){r.preventDefault(),g=new Date,t.core.touchAction="zoomSwipe",m=t.core.getSlideItem(t.core.index).find(".lg-img-wrap").first();var l=t.getDragAllowedAxises(Math.abs(t.rotateValue));i=l.allowY,s=l.allowX,(s||i)&&(e=t.getSwipeCords(r,Math.abs(t.rotateValue))),h=t.getPossibleSwipeDragCords(t.rotateValue),t.core.outer.addClass("lg-zoom-dragging lg-zoom-drag-transition")}}),this.core.$inner.on("touchmove.lg",function(r){if(r.targetTouches.length===1&&t.core.touchAction==="zoomSwipe"&&(t.$LG(r.target).hasClass("lg-item")||u.get().contains(r.target))){r.preventDefault(),t.core.touchAction="zoomSwipe",o=t.getSwipeCords(r,Math.abs(t.rotateValue));var l=t.getZoomSwipeCords(e,o,s,i,h);(Math.abs(o.x-e.x)>15||Math.abs(o.y-e.y)>15)&&(a=!0,t.setZoomSwipeStyles(m,l))}}),this.core.$inner.on("touchend.lg",function(r){if(t.core.touchAction==="zoomSwipe"&&(t.$LG(r.target).hasClass("lg-item")||u.get().contains(r.target))){if(t.core.touchAction=void 0,t.core.outer.removeClass("lg-zoom-dragging"),!a)return;a=!1,c=new Date;var l=c.valueOf()-g.valueOf();t.touchendZoom(e,o,s,i,l,t.rotateValue)}})},n.prototype.zoomDrag=function(){var t=this,e={},o={},a=!1,s=!1,i=!1,g=!1,c,h,m,u;this.core.outer.on("mousedown.lg.zoom",function(r){if(!!t.isImageSlide()){var l=t.core.getSlideItem(t.core.index);if(t.$LG(r.target).hasClass("lg-item")||l.get().contains(r.target)){c=new Date,u=t.core.getSlideItem(t.core.index).find(".lg-img-wrap").first();var v=t.getDragAllowedAxises(Math.abs(t.rotateValue));g=v.allowY,i=v.allowX,t.core.outer.hasClass("lg-zoomed")&&t.$LG(r.target).hasClass("lg-object")&&(i||g)&&(r.preventDefault(),e=t.getDragCords(r,Math.abs(t.rotateValue)),m=t.getPossibleSwipeDragCords(t.rotateValue),a=!0,t.core.outer.get().scrollLeft+=1,t.core.outer.get().scrollLeft-=1,t.core.outer.removeClass("lg-grab").addClass("lg-grabbing lg-zoom-drag-transition lg-zoom-dragging"))}}}),this.$LG(window).on("mousemove.lg.zoom.global"+this.core.lgId,function(r){if(a){s=!0,o=t.getDragCords(r,Math.abs(t.rotateValue));var l=t.getZoomSwipeCords(e,o,i,g,m);t.setZoomSwipeStyles(u,l)}}),this.$LG(window).on("mouseup.lg.zoom.global"+this.core.lgId,function(r){if(a){if(h=new Date,a=!1,t.core.outer.removeClass("lg-zoom-dragging"),s&&(e.x!==o.x||e.y!==o.y)){o=t.getDragCords(r,Math.abs(t.rotateValue));var l=h.valueOf()-c.valueOf();t.touchendZoom(e,o,i,g,l,t.rotateValue)}s=!1}t.core.outer.removeClass("lg-grabbing").addClass("lg-grab")})},n.prototype.closeGallery=function(){this.resetZoom()},n.prototype.destroy=function(){this.$LG(window).off(".lg.zoom.global"+this.core.lgId),this.core.LGel.off(".lg.zoom"),this.core.LGel.off(".zoom"),clearTimeout(this.zoomableTimeout),this.zoomableTimeout=!1},n}();export{b as default};
